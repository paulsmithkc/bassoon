/*! @version bassoon 1.0.7 */(()=>{"use strict";var e={d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function r(){function e(t,r,a){var s=new RegExp(t,r);return c.set(s,a||c.get(t)),n(s,e.prototype)}function t(e,t){var r=c.get(t);return Object.keys(r).reduce((function(t,a){return t[a]=e[r[a]],t}),Object.create(null))}r=function(t,r){return new e(t,void 0,r)};var s=RegExp.prototype,c=new WeakMap;return a(e,RegExp),e.prototype.exec=function(e){var r=s.exec.call(this,e);return r&&(r.groups=t(r,this)),r},e.prototype[Symbol.replace]=function(e,r){if("string"==typeof r){var a=c.get(this);return s[Symbol.replace].call(this,e,r.replace(/\$<([^>]+)>/g,(function(e,t){return"$"+a[t]})))}if("function"==typeof r){var n=this;return s[Symbol.replace].call(this,e,(function(){var e=arguments;return"object"!=typeof e[e.length-1]&&(e=[].slice.call(e)).push(t(e,n)),r.apply(this,e)}))}return s[Symbol.replace].call(this,e,r)},r.apply(this,arguments)}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){function t(){c=!0,y&&(y.onreadystatechange=null,y.onload=null,y.onerror=null,y.abort())}function a(e){c||(b?(v.push(e),v.length>=b&&(s.emit("data",v),v=[])):s.emit("data",e))}var n="string"==typeof e?{url:e}:e,s={_events:{},_get:function(e){return this._events[e]||(this._events[e]={callback:null,queue:[]}),this._events[e]},on:function(e,t){var r=this._get(e),a=r.queue;if(r.callback=t,t&&a.length){for(var n=0;n<a.length;++n)t.call(this,a[n]);r.queue=[]}return this},emit:function(e,t){var r=this._get(e),a=r.callback;return a?a.call(this,t):r.queue.push(t),this}},c=!1;if(n.worker&&Worker){n.url=new URL(n.url,location).toString();var u=n.workerPath||"/bassoon/bassoon-worker.min.js",o=new Worker(u);return o.onmessage=function(e){c||s.emit(e.data.cmd,e.data.data)},o.postMessage({cmd:"start",args:n}),s.abort=function(){c=!0,o.postMessage({cmd:"abort"})},s}var l=n.url,i=n.method||"GET",p=n.withCredentials||!1,f=n.verbose||!1,b=n.chunkSize,h=function(e){function t(t,r){(e=I.callback)&&e({key:t,data:r,depth:R.length})}function a(){var e=k;return e.lastIndex=q,!!(S=e.exec(T))&&(q=e.lastIndex-1,t("key",S.groups.value1||S.groups.value2),_=i,!0)}function n(e){var r=null;return e===p?r=d:e===f?r=w:e===b?r=x:e===h?r=m:e===y?r=E:e===g&&(r=j),r.lastIndex=q,!(!(S=r.exec(T))||(q=r.lastIndex-2,e===p?O=S.groups.value:e===f?O=parseFloat(S.groups.value):e===b?O=!0:e===h?O=!1:e===y?O=null:e===g&&(O=void 0),t("value",O),_!==c&&(_=R.pop()),0))}function s(e){for(T+=e;q<T.length;++q){var r=T[q];switch(_){case v:q=T.length;break;case c:case i:switch(r){case" ":case"\t":case"\n":case"\r":break;case"[":t("openarray"),_=u;break;case"{":t("openobject"),_=o;break;case'"':if(!n(p))return;break;case"-":case"+":case".":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(!n(f))return;break;case"t":case"T":if(!n(b))return;break;case"f":case"F":if(!n(h))return;break;case"n":case"N":if(!n(y))return;break;default:if(!n(g))return}break;case u:switch(r){case" ":case"\t":case"\n":case"\r":break;case"]":t("closearray"),_=R.length?R.pop():c;break;case",":break;default:R.push(_),_=i,--q}break;case o:switch(r){case" ":case"\t":case"\n":case"\r":break;case"}":t("closeobject"),_=R.length?R.pop():c;break;case"{":case"[":case"]":case",":break;default:R.push(_),_=l,--q}break;case l:if(!a())return;break;default:throw new Error("unexpected state "+_)}}T=T.substring(q),q=0}var c=0,u=1,o=2,l=3,i=4,p=5,f=6,b=7,h=8,y=9,g=10,v=11,k=r(new RegExp('(("((?:(?!["\\\\])[\\s\\S])+)")|([0-9A-Z_a-z]+))[\\t\\n\\r ]*:[\\t\\n\\r ]*',"y"),{value1:3,value2:4}),d=r(new RegExp('"((?:(?:(?!["\\\\])[\\s\\S])|(?:\\\\["\\/\\\\bfnrtv])|(?:\\\\u[0-9A-Fa-f]{4}))*)"[\\t\\n\\r ,\\]\\}]',"y"),{value:1}),w=r(new RegExp("([\\+\\x2D]?[0-9]+(.[0-9]+)?([Ee][\\+\\x2D]?[0-9]+)?)[\\t\\n\\r ,\\]\\}]","y"),{value:1}),x=r(new RegExp("(true)[\\t\\n\\r ,\\]\\}]","iy"),{value:1}),m=r(new RegExp("(false)[\\t\\n\\r ,\\]\\}]","iy"),{value:1}),E=r(new RegExp("(null)[\\t\\n\\r ,\\]\\}]","iy"),{value:1}),j=new RegExp("[^ \\t\\n\\r,}\\]]+[ \\t\\n\\r,}\\]]","y"),R=[],_=c,O=null,S=null,T="",q=0,I={parse:s,end:function(){return s(",")},callback:e};return I}((function(e){var t=e.key,r=e.data,n=e.depth;if(!c)if(f&&console.log(" ".repeat(2*n),t,r),d)switch(t){case"openarray":k.push({curObj:d,curKey:w}),d=[],w=null;break;case"openobject":k.push({curObj:d,curKey:w}),d={},w=null;break;case"closearray":case"closeobject":if(k.length){var s,u=d;s=k.pop(),d=s.curObj,null===(w=s.curKey)?d.push(u):(d[w]=u,w=null)}else a(d),d=w=null;break;case"key":w=r;break;case"value":null===w?d.push(r):(d[w]=r,w=null)}else switch(t){case"openarray":case"closearray":break;case"openobject":d={};break;case"value":a(r)}})),y=null,g=0,v=[],k=[],d=null,w=null;try{(y=new XMLHttpRequest).open(i||"GET",l),y.responseType="text",y.withCredentials=p,y.onreadystatechange=function(e){try{if(y.readyState>2){var r=y.responseText,a=r.substr(g);g=r.length,h.parse(a)}}catch(e){t(),s.emit("error",e)}},y.onload=function(e){try{h.end(),k.length?a(k[0]):d&&a(d),v.length&&s.emit("data",v),s.emit("end",{status:y.status,statusText:y.statusText})}catch(e){s.emit("error",e)}},y.onerror=function(e){var t=new Error("Network Error");t.status=y.status,t.statusText=y.statusText,t.timeout=y.timeout,s.emit("error",t)},y.send()}catch(e){console.error(e),t(),s.emit("error",e)}return s.abort=t,s}e.d(t,{default:()=>s}),self.bassoon=t.default})();
//# sourceMappingURL=bassoon.min.js.map